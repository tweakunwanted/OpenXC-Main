module.exports=function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";function i(e){var t=new r(e);o._=o.gettext=t.gettext,o.pgettext=t.pgettext,o.ngettext=t.ngettext}var a=n(2),r=n(4),o=new a;o.defaultLanguage="en",o.load=function(e,t){var n;t=t||null,e.ext=e.ext||"json",e.path=e.path||"lang",e.name===o.defaultLanguage?(i(),null!==t&&t(null)):(n=new XMLHttpRequest,n.onload=function(){var e,a;try{a=JSON.parse(n.responseText)}catch(t){e=t}e?n.onerror(e):(i(a),null!==t&&t(null),o.events["load"]&&o.emit("load"))},n.ontimeout=n.onerror=function(e){i(),null!==t&&t(null),o.events["error"]&&o.emit("error",e)},n.open("GET",e.path+"/"+e.name+"."+e.ext,!0),n.send(null))},e.exports=o},function(e,t,n){"use strict";function i(){var e;try{e=JSON.parse(gSTB.GetStorageInfo("{}")),e=e.result,e=e.map(function(e){return{name:e.vendor+e.model,value:e.mountPath}})}catch(t){e=[]}return e}function a(e,t){var n;switch(e){case 1:f.emit("start");break;case 2:f.emit("stop");break;case 3:f.emit("buffer:pause:full");break;case 4:f.emit("buffer:full");break;case 5:f.emit("buffer:almost:full");break;case 6:1===t?n="storage:unavailable":2===t&&(n="storage:full"),f.emit(n)}}function r(e){var t,n=e.storage.getItem("timeShiftDelay"),r=e.storage.getItem("timeShiftLength"),o=e.storage.getItem("timeShiftOnExitHandler"),c=e.storage.getItem("timeShiftBufferCyclicMode"),l=e.storage.getItem("timeShiftEnable");n&&(f.delay=n),f.onExit=void 0===o?f.EXIT_NOT_SAVE:o,f.cyclic=c,s.icon=e.storage.getItem("timeShiftIconDisplay"),l&&(s.enable=l),f.enable=s.enable,t=i(),t.length&&(f.path=t[0].value+"/"+f.SAVE_FOLDER_NAME),window.stbEvent.addListener("message",function(e){var t=[];e.broadcast&&"storage.mount"===e.message&&(t=i(),t.length&&(f.path=t[0].value+"/"+f.SAVE_FOLDER_NAME))}),f.length=r||3600,window.stbEvent.addListener("media",function(e){36===e.code&&e.info&&"TimeShift"===e.info.ident&&a(e.info.event_code,e.info.event_data)}),window.top.MODE_PORTAL&&(f.ALLOW_MANUAL=!0),u=!0}var o=n(2),c=window.timeShift||window.top.timeShift||{},u=!1,s={enable:!1,icon:!0,delay:0,cyclic:!1,onExit:0,length:3600,path:null},f=new o;Object.defineProperties(f,{enable:{set:function(e){s.enable=!!e,f.emit("change","enable",s.enable)},get:function(){return s.enable}},onExit:{set:function(e){s.onExit=e,f.emit("change","onExit",s.onExit)},get:function(){return s.onExit}},delay:{set:function(e){s.delay=e,f.emit("change","delay",s.delay)},get:function(){return s.delay}},displayIcon:{get:function(){return s.icon},set:function(e){e=!!e,s.icon=e,f.emit("change","displayIcon",s.icon)}},cyclic:{set:function(e){s.cyclic=!!e,c.SetSlidingMode(s.cyclic),f.emit("change","cyclic",s.cyclic)},get:function(){return s.cyclic}},length:{set:function(e){c.SetMaxDuration(e),s.length=e,f.emit("change","length",s.length)},get:function(){return s.length}},path:{set:function(e){c.SetTimeShiftFolder(e),s.path=e},get:function(){return s.path}},mountUsb:{get:function(){var e=!1;return s.path&&(e=s.path.replace("/"+f.SAVE_FOLDER_NAME,"")),e}}}),f.EXIT_NOT_SAVE=0,f.EXIT_SAVE=1,f.EXIT_REQUEST_SAVE=2,f.SAVE_FOLDER_NAME="records",f.setSlidingMode=function(e){c.SetSlidingMode(e)},f.checkAbility=function(e){var t=!1;return e=e||{},(/rtp\:|udp\:/.test(e.uri)||/ffrt\s/.test(e.uri)||"ffrt"===e.solution)&&(t=!0),t},f.enter=function(){return top.timeShift.EnterTimeShift()},f.exit=function(e){return e&&e.save&&e.save.path&&e.save.name?top.timeShift.ExitTimeShiftAndSave(e.save.path,e.save.name):top.timeShift.ExitTimeShift()},e.exports=function(e){return u||r(e),f}},function(e,t,n){"use strict";function i(){this.events={}}i.prototype={addListener:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},once:function(e,t){var n=this;this.events[e]=this.events[e]||[],this.events[e].push(function i(){t.apply(n,arguments),n.removeListener(e,i)})},addListeners:function(e){var t;for(t in e)e.hasOwnProperty(t)&&this.addListener(t,e[t])},removeListener:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}),0===this.events[e].length&&(this.events[e]=void 0))},emit:function(e){var t,n=this.events[e];if(n)for(t=0;t<n.length;t++)n[t].apply(this,Array.prototype.slice.call(arguments,1))}},i.prototype.constructor=i,e.exports=i},function(e,t,n){"use strict";var i=n(1);e.exports={onSettingsInit:function(e,t){n(0).load({name:window.core.environment.language||"en",path:core.packageMap["magcore-plugin-timeshift"].url+"/../lang"},function(){var i,a=n(0).gettext;i={sections:[{id:"timeshift",name:a("Timeshift"),description:a('TimeShift function allows you to record the broadcast of a channel on the USB-stick by pressing the "Pause" button on the remote control. When you press the "Pause" button again, the recording will continue and the channel will start playing from the storage device starting from the moment you first pressed the "Pause" button.'),icon:"theme-icon-timeshift",parent:"system"}],options:[n(5)(e),n(6)(e),n(8)(e),n(9)(e),n(10)(e)]},t(!1,i)})},onAppInit:function(e,t){t(null,i(e))}}},function(module,exports,__webpack_require__){"use strict";function Gettext(config){var data,meta;config=config||{},data=config.data||{},data[""]=data[""]||{},meta=config.meta,this.gettext=function(e){return data[""][e]||e},this.pgettext=function(e,t){return data[e]&&data[e][t]||t},this.ngettext=function(msgId,plural,value){var n;return data&&meta&&data[""][msgId]?data[""][msgId][eval("n = "+value+"; "+meta.plural)]:1===value?msgId:plural}}Gettext.prototype.constructor=Gettext,module.exports=Gettext},function(e,t,n){"use strict";e.exports=function(e){var t=n(1)(e),i=n(0).gettext;return{id:"timeShiftEnable",name:i("Enable timeshift"),description:i("Enable Timeshift function."),icon:"theme-icon-timeshift",data:{timeShiftEnable:!1},saveImmediate:!0,prepareForRender:function(e,t){t(!!e.timeShiftEnable)},prepareForSave:function(e,n){this.data.timeShiftEnable=e,t.enable=e,n()},render:e.api.renders.toggle,parent:"timeshift"}}},function(e,t,n){"use strict";e.exports=function(e){var t=n(1)(e),i=n(0).gettext;return{id:"timeShiftLength",name:i("Length"),description:i("Setting the recording duration made by TimeShift."),icon:"theme-icon-clock",data:{timeShiftLength:3600},saveImmediate:!0,prepareForRender:function(e,t){var i=n(7);i.forEach(function(t){t.selected=t.value===e.timeShiftLength}),t(i)},prepareForSave:function(e,n){this.data.timeShiftLength=e,t.length=e,n()},render:e.api.renders.popupSelect,parent:"timeshift"}}},function(e,t,n){"use strict";e.exports=[{name:"15 "+_("min"),value:900},{name:"30 "+_("min"),value:1800},{name:"1 "+_("hour"),value:3600},{name:"2 "+_("hours"),value:7200},{name:"3 "+_("hours"),value:10800},{name:"5 "+_("hours"),value:18e3},{name:"10 "+_("hours"),value:36e3},{name:"20 "+_("hours"),value:72e3},{name:"24 "+_("hours"),value:86400}]},function(e,t,n){"use strict";e.exports=function(e){var t=n(1)(e),i=n(0).gettext;return{id:"timeShiftBufferMode",name:i("Using buffer mode"),description:i("Buffer usage mode is determined by the parameters: Cyclic overwrite - recording to the buffer is performed cyclically, once it is full the repeated record is made. Stop on filling - the record ends after the storage space is over."),icon:"theme-icon-categories",data:{timeShiftBufferCyclicMode:!1},saveImmediate:!0,prepareForRender:function(e,t){var n=[{name:i("Cyclic record mode"),value:!0},{name:i("Stop when out of space"),value:!1}];n.forEach(function(t){t.selected=t.value===e.timeShiftBufferCyclicMode}),t(n)},prepareForSave:function(e,n){this.data.timeShiftBufferCyclicMode=e,t.cyclic=e,n()},render:e.api.renders.popupSelect,parent:"timeshift"}}},function(e,t,n){"use strict";e.exports=function(e){var t=n(1)(e),i=n(0).gettext;return{id:"timeShiftOnExit",name:i("On exit"),description:i("Setting save content on exit (completion of TimeShift function use)."),icon:"theme-icon-shortcut",data:{timeShiftOnExitHandler:0},saveImmediate:!0,prepareForRender:function(e,n){var a=[{name:i("Do not save buffer"),value:t.EXIT_NOT_SAVE},{name:i("Save buffer"),value:t.EXIT_SAVE}];window.top.MODE_PORTAL&&a.push({name:i("Request to save"),value:t.EXIT_REQUEST_SAVE}),a.forEach(function(t){t.selected=t.value===e.timeShiftOnExitHandler}),n(a)},prepareForSave:function(e,n){this.data.timeShiftOnExitHandler=e,t.onExit=e,n()},render:e.api.renders.popupSelect,parent:"timeshift"}}},function(e,t,n){"use strict";e.exports=function(e){var t=n(1)(e),i=n(0).gettext;return{id:"timeShiftDelay",name:i("Delay"),description:i("Delay before the recording start by the TimeShift function."),icon:"theme-icon-sand-clock",data:{timeShiftDelay:0},saveImmediate:!0,prepareForRender:function(e,t){var n=[{name:i("By pressing Pause Button"),value:0},{name:"1 "+i("sec"),value:1e3},{name:"3 "+i("sec"),value:3e3},{name:"5 "+i("sec"),value:5e3},{name:"10 "+i("sec"),value:1e4}];n.forEach(function(t){t.selected=t.value===e.timeShiftDelay}),t(n)},prepareForSave:function(e,n){this.data.timeShiftDelay=e,t.delay=e,n()},render:e.api.renders.popupSelect,parent:"timeshift"}}}]);